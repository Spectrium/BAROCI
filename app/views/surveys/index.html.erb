<h1>Notre Candidat élu et ses promesses</h1>

<p>Voici tous ses promesses et ces engagements </p>
<ol>
	<% @promesse.each do |promesse| %>
		<li>
			<%= promesse.content %>
			<ul>
				<% promesse.engagments.each do |engagement| %>
					<li>
						<%= engagement.content %>
					</li>
					
					<% number = engagement.surveys.all %>
						<%= form_tag url_for(action:'create'), method:'post' do %>
							
							<input type="text" name="engagement" value="<%= engagement.id %>" hidden>
							<input type="text" name="name" value="1" hidden>
							<input type="submit" value="D'accord">(<%= number.where(agree: true).count %>)
						</br>
						<%end%>

						<%= form_tag url_for(action:'create'), method:'post' do %>
							<input type="text" name="engagement" value="<%= engagement.id %>" hidden>
							<input type="text" name="name" value="2" hidden>
							<input type="submit" value="Pas d'accord">(<%= number.where(disagree: true).count %>)
						<%end%>
						<%= form_tag url_for(action:'create'), method:'post' do %>
							<input type="text" name="engagement" value="<%= engagement.id %>" hidden>
							<input type="text" name="name" value="3" hidden>
							<input type="submit" value="Hesiter">(<%= number.where(hesitat: true).count %>)
						<%end%>
						<%= link_to "Commentaire", new_engagment_comment_path(engagement.id) %>(<%= engagement.comments.count %>) <br>

						<strong>Résultat sur le sondage des engagements : </strong>
						<% total = engagement.surveys.count %>
						<% survey = Survey.where(engagment: engagement) %>
						<% surveyagree = survey.where(agree: true) %>
						<% surveydisagree = survey.where(disagree: true) %>
						<% surveyhes = survey.where(hesitat: true) %>
						<% if total != 0 %>

							D'accord : <%= (surveyagree.count * 100)/total %> %
							Pas d'accord : <%= (surveydisagree.count * 100)/total %>%
							Hesitation : <%= (surveyhes.count * 100)/total %>%

						<% end %>
				<% end %>
			</ul>
		</li>
	<% end %>
</ol>

   <div class="row">

        <!-- Content Column -->
        <div class="col-lg-6 mb-4">

          <!-- Project Card Example -->
          <div class="card shadow mb-4">
            <div class="card-header py-3">
              <h6 class="m-0 font-weight-bold text-primary"><h5>Le candidat <%= @candidat_valid.name %> est élu avec un résultat de <%= @candidat_valid.resultat %> % </h5> <br></h6></h6>
            </div>
            <div class="card-body">
              <h4 class="small font-weight-bold">Projet Faits <span class="float-right">20%</span></h4>
              <h4 class="small font-weight-bold">Agree : <span class="float-right"><%= (surveyagree.count * 100)/total %> %</span></h4>
              <div class="progress mb-4">
                <div class="progress-bar bg-danger" role="progressbar" style="width: <%= (surveyagree.count * 100)/total %>%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
              <h4 class="small font-weight-bold">Projets En Cours <span class="float-right">40%</span></h4>
              <div class="progress mb-4">
                <div class="progress-bar bg-warning" role="progressbar" style="width: 40%" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
              <h4 class="small font-weight-bold"> Projets <span class="float-right">60%</span></h4>
              <div class="progress mb-4">
                <div class="progress-bar" role="progressbar" style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-6 mb-4">
            <div class="card-body">
              <div class="text-center">
                <img class="img-fluid px-3 px-sm-4 mt-3 mb-4" style="width: 25rem;"src="img/undraw_posting_photo.svg" alt="">
              </div>
              <p>Toutes ces projets sont tirées des discours et promesses du candidats lors de  <a target="_blank" rel="nofollow" href="#">l'election </a>, et toutes les visiteurs du site web ont droit de soummetre des sondage du progrès de ces projets</p>
              <a target="_blank" rel="nofollow" href="#">Voirs les discours du candidats &rarr;</a>
            </div>
          </div>
        </div>
      </div>
